name: Gemini PR Code Reviewer

on:
  # This workflow runs only when a Pull Request is opened, reopened, or synchronized (new commits pushed)
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  code-review:
    runs-on: ubuntu-latest
    
    permissions:
      contents: read         # Needed to read the code diff
      pull-requests: write   # Needed to post comments/review on the PR

    steps:
      - name: Checkout Code
        # Fetches the code, including the history needed to calculate the diff
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 

      - name: Run Gemini AI Code Review
        # Using a popular, simple GitHub Action designed for code review with Gemini
        # This action handles extracting the diff and prompting the model.
        uses: xh-dev-lab/gemini-ai-code-reviewer@v1
        with:
          # Your API key, securely retrieved from the repository secrets
          gemini_api_key: ${{ secrets.GEMINI_API_KEY }} 
          
          # The default GitHub token, used by the action to post comments back to the PR
          github_token: ${{ secrets.GITHUB_TOKEN }} 
          
          # OPTIONAL: Choose a model. 'flash' is fast and free-tier-friendly.
          gemini_model: "gemini-2.5-flash" 
          
          # OPTIONAL: Customize the instruction/prompt for the model
          extra_prompt: "As a professional reviewer, check for logic errors, security vulnerabilities, adherence to coding standards, and suggest best practices. Be concise."name: Gemini PR Code Reviewer

on:
  # This workflow runs only when a Pull Request is opened, reopened, or synchronized (new commits pushed)
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  code-review:
    runs-on: ubuntu-latest
    
    permissions:
      contents: read         # Needed to read the code diff
      pull-requests: write   # Needed to post comments/review on the PR

    steps:
      - name: Checkout Code
        # Fetches the code, including the history needed to calculate the diff
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 

      - name: Run Gemini AI Code Review
        # Using a popular, simple GitHub Action designed for code review with Gemini
        # This action handles extracting the diff and prompting the model.
        uses: xh-dev-lab/gemini-ai-code-reviewer@v1
        with:
          # Your API key, securely retrieved from the repository secrets
          gemini_api_key: ${{ secrets.GEMINI_API_KEY }} 
          
          # The default GitHub token, used by the action to post comments back to the PR
          github_token: ${{ secrets.GITHUB_TOKEN }} 
          
          # OPTIONAL: Choose a model. 'flash' is fast and free-tier-friendly.
          gemini_model: "gemini-2.5-flash" 
          
          # OPTIONAL: Customize the instruction/prompt for the model
          extra_prompt: "As a professional reviewer, check for logic errors, security vulnerabilities, adherence to coding standards, and suggest best practices. Be concise."